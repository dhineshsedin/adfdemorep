{
	"name": "chkperfmnce",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable8",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlTable7",
						"type": "DatasetReference"
					},
					"name": "source2"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlTable9",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable5",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "join1"
				},
				{
					"name": "join2"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          asn_key as long,",
				"          asn_hr_key as long,",
				"          asn_dtl_key as long,",
				"          gate_exec_dtl_key as long,",
				"          asn_loc_key as long,",
				"          asn_date_key as long,",
				"          asn_cust_key as long,",
				"          asn_dtl_itm_hdr_key as long,",
				"          gate_exec_dtl_veh_key as long,",
				"          asn_ou as integer,",
				"          asn_location as string,",
				"          asn_no as string,",
				"          asn_lineno as integer,",
				"          asn_prefdoc_type as string,",
				"          asn_prefdoc_no as string,",
				"          asn_prefdoc_date as timestamp,",
				"          asn_date as date,",
				"          asn_status as string,",
				"          asn_operation_status as string,",
				"          asn_ib_order as string,",
				"          asn_ship_frm as string,",
				"          asn_dlv_date as timestamp,",
				"          asn_sup_asn_no as string,",
				"          asn_sup_asn_date as timestamp,",
				"          asn_sent_by as string,",
				"          asn_ship_date as timestamp,",
				"          asn_rem as string,",
				"          asn_shp_ref_typ as string,",
				"          asn_shp_ref_no as string,",
				"          asn_shp_ref_date as timestamp,",
				"          asn_shp_carrier as string,",
				"          asn_shp_mode as string,",
				"          asn_shp_rem as string,",
				"          asn_cust_code as string,",
				"          asn_type as string,",
				"          asn_reason_code as string,",
				"          asn_gate_no as string,",
				"          asn_created_date as timestamp,",
				"          asn_modified_date as timestamp,",
				"          gate_actual_date as timestamp,",
				"          gate_ser_provider as string,",
				"          gate_veh_type as string,",
				"          gate_vehicle_no as string,",
				"          gate_employee as string,",
				"          gate_created_date as timestamp,",
				"          asn_line_status as string,",
				"          asn_itm_code as string,",
				"          asn_qty as decimal(20,2),",
				"          asn_rec_qty as decimal(20,2),",
				"          asn_acc_qty as decimal(20,2),",
				"          asn_rej_qty as decimal(20,2),",
				"          asn_order_uom as string,",
				"          asn_master_uom_qty as decimal(20,2),",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp,",
				"          createdatetime as timestamp,",
				"          updatedatetime as timestamp,",
				"          asn_itm_itemgroup as string,",
				"          asn_itm_class as string,",
				"          activeindicator as integer,",
				"          asn_cutofftime as timestamp,",
				"          asn_qualifieddate as timestamp,",
				"          asn_qualifieddatekey as long,",
				"          asn_openingtime as timestamp,",
				"          sourcename as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source1",
				"source(output(",
				"          gr_itm_dtl_key as long,",
				"          gr_dtl_key as long,",
				"          gr_itm_dtl_loc_key as long,",
				"          gr_itm_dtl_itm_hdr_key as long,",
				"          gr_itm_dtl_uom_key as long,",
				"          gr_itm_dtl_thu_key as long,",
				"          gr_itm_dtl_stg_mas_key as long,",
				"          gr_loc_code as string,",
				"          gr_exec_no as string,",
				"          gr_exec_ou as integer,",
				"          gr_lineno as integer,",
				"          gr_po_no as string,",
				"          gr_po_sno as string,",
				"          gr_item as string,",
				"          gr_item_qty as decimal(20,2),",
				"          gr_lot_no as string,",
				"          gr_acpt_qty as decimal(20,2),",
				"          gr_rej_qty as decimal(20,2),",
				"          gr_storage_unit as string,",
				"          gr_mas_uom as string,",
				"          gr_su_qty as decimal(20,2),",
				"          gr_uid_sno as string,",
				"          gr_manu_date as timestamp,",
				"          gr_exp_date as timestamp,",
				"          gr_exe_asn_line_no as integer,",
				"          gr_exe_wh_bat_no as string,",
				"          gr_exe_supp_bat_no as string,",
				"          gr_asn_srl_no as string,",
				"          gr_asn_uid as string,",
				"          gr_asn_cust_sl_no as string,",
				"          gr_asn_ref_doc_no1 as string,",
				"          gr_asn_consignee as string,",
				"          gr_asn_outboundorder_qty as decimal(20,2),",
				"          gr_asn_bestbeforedate as timestamp,",
				"          gr_asn_remarks as string,",
				"          gr_plan_no as string,",
				"          gr_execution_date as timestamp,",
				"          gr_reasoncode as string,",
				"          gr_cross_dock as string,",
				"          gr_thu_id as string,",
				"          gr_thu_sno as string,",
				"          gr_stag_id as string,",
				"          gr_stock_status as string,",
				"          gr_inv_type as string,",
				"          gr_product_status as string,",
				"          gr_coo as string,",
				"          gr_item_attribute1 as string,",
				"          gr_item_attribute2 as string,",
				"          gr_item_attribute3 as string,",
				"          gr_item_in_stage as string,",
				"          gr_item_to_stage as string,",
				"          gr_pal_status as string,",
				"          gr_item_hht_save_flag as string,",
				"          gr_updated_from as string,",
				"          gr_last_updated_by as string,",
				"          gr_item_attribute7 as string,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source2",
				"source(output(",
				"          gr_dtl_key as long,",
				"          gr_loc_key as long,",
				"          gr_emp_hdr_key as long,",
				"          gr_date_key as long,",
				"          gr_stg_mas_key as long,",
				"          gr_loc_code as string,",
				"          gr_exec_no as string,",
				"          gr_exec_ou as integer,",
				"          gr_pln_no as string,",
				"          gr_pln_ou as integer,",
				"          gr_pln_date as timestamp,",
				"          gr_po_no as string,",
				"          gr_no as string,",
				"          gr_emp as string,",
				"          gr_start_date as timestamp,",
				"          gr_end_date as timestamp,",
				"          gr_exec_status as string,",
				"          gr_created_by as string,",
				"          gr_created_date as timestamp,",
				"          gr_modified_by as string,",
				"          gr_modified_date as timestamp,",
				"          gr_timestamp as integer,",
				"          gr_asn_no as string,",
				"          gr_staging_id as string,",
				"          gr_exec_date as timestamp,",
				"          gr_build_complete as string,",
				"          gr_notype as string,",
				"          gr_ref_type as string,",
				"          gr_gen_from as string,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source3",
				"source1, source2 join(asn_loc_key == gr_itm_dtl_loc_key",
				"     && asn_dtl_itm_hdr_key == gr_itm_dtl_itm_hdr_key",
				"     && asn_prefdoc_no == gr_po_no,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1, source3 join(source2@gr_dtl_key == source3@gr_dtl_key",
				"     && source2@gr_po_no == source3@gr_po_no",
				"     && gr_itm_dtl_loc_key == gr_loc_key,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"join2 derive(asn_loc_key = coalesce(asn_loc_key,-1),",
				"          gr_dtl_key = coalesce(source3@gr_dtl_key,-1),",
				"          gr_itm_dtl_key = coalesce(gr_itm_dtl_key,-1),",
				"          asn_key = coalesce(asn_key,-1),",
				"          gr_emp_hdr_key = coalesce(gr_emp_hdr_key,-1),",
				"          gr_itm_dtl_itm_hdr_key = coalesce(gr_itm_dtl_itm_hdr_key,-1),",
				"          gr_itm_dtl_uom_key = coalesce(gr_itm_dtl_uom_key,-1),",
				"          gr_itm_dtl_stg_mas_key = coalesce(gr_itm_dtl_stg_mas_key,-1),",
				"          etlcreatedatetime = currentTimestamp(),",
				"          activeindicator = 1) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          gr_itm_dtl_key as long,",
				"          gr_dtl_key as long,",
				"          gr_itm_dtl_loc_key as long,",
				"          gr_itm_dtl_itm_hdr_key as long,",
				"          gr_itm_dtl_uom_key as long,",
				"          gr_itm_dtl_thu_key as long,",
				"          gr_itm_dtl_stg_mas_key as long,",
				"          gr_loc_code as string,",
				"          gr_exec_no as string,",
				"          gr_exec_ou as integer,",
				"          gr_lineno as integer,",
				"          gr_po_no as string,",
				"          gr_po_sno as string,",
				"          gr_item as string,",
				"          gr_item_qty as decimal(20,2),",
				"          gr_lot_no as string,",
				"          gr_acpt_qty as decimal(20,2),",
				"          gr_rej_qty as decimal(20,2),",
				"          gr_storage_unit as string,",
				"          gr_mas_uom as string,",
				"          gr_su_qty as decimal(20,2),",
				"          gr_uid_sno as string,",
				"          gr_manu_date as timestamp,",
				"          gr_exp_date as timestamp,",
				"          gr_exe_asn_line_no as integer,",
				"          gr_exe_wh_bat_no as string,",
				"          gr_exe_supp_bat_no as string,",
				"          gr_asn_srl_no as string,",
				"          gr_asn_uid as string,",
				"          gr_asn_cust_sl_no as string,",
				"          gr_asn_ref_doc_no1 as string,",
				"          gr_asn_consignee as string,",
				"          gr_asn_outboundorder_qty as decimal(20,2),",
				"          gr_asn_bestbeforedate as timestamp,",
				"          gr_asn_remarks as string,",
				"          gr_plan_no as string,",
				"          gr_execution_date as timestamp,",
				"          gr_reasoncode as string,",
				"          gr_cross_dock as string,",
				"          gr_thu_id as string,",
				"          gr_thu_sno as string,",
				"          gr_stag_id as string,",
				"          gr_stock_status as string,",
				"          gr_inv_type as string,",
				"          gr_product_status as string,",
				"          gr_coo as string,",
				"          gr_item_attribute1 as string,",
				"          gr_item_attribute2 as string,",
				"          gr_item_attribute3 as string,",
				"          gr_item_in_stage as string,",
				"          gr_item_to_stage as string,",
				"          gr_pal_status as string,",
				"          gr_item_hht_save_flag as string,",
				"          gr_updated_from as string,",
				"          gr_last_updated_by as string,",
				"          gr_item_attribute7 as string,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp,",
				"          gr_loc_key as long,",
				"          gr_emp_hdr_key as long,",
				"          gr_date_key as long,",
				"          gr_stg_mas_key as long,",
				"          gr_pln_no as string,",
				"          gr_pln_ou as integer,",
				"          gr_pln_date as timestamp,",
				"          gr_no as string,",
				"          gr_emp as string,",
				"          gr_start_date as timestamp,",
				"          gr_end_date as timestamp,",
				"          gr_exec_status as string,",
				"          gr_created_by as string,",
				"          gr_created_date as timestamp,",
				"          gr_modified_by as string,",
				"          gr_modified_date as timestamp,",
				"          gr_timestamp as integer,",
				"          gr_asn_no as string,",
				"          gr_staging_id as string,",
				"          gr_exec_date as timestamp,",
				"          gr_build_complete as string,",
				"          gr_notype as string,",
				"          gr_ref_type as string,",
				"          gr_gen_from as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          gr_itm_dtl_key,",
				"          gr_itm_dtl_loc_key,",
				"          gr_itm_dtl_itm_hdr_key,",
				"          gr_itm_dtl_uom_key,",
				"          gr_itm_dtl_thu_key,",
				"          gr_itm_dtl_stg_mas_key,",
				"          gr_lineno,",
				"          gr_po_sno,",
				"          gr_item,",
				"          gr_item_qty,",
				"          gr_lot_no,",
				"          gr_acpt_qty,",
				"          gr_rej_qty,",
				"          gr_storage_unit,",
				"          gr_mas_uom,",
				"          gr_su_qty,",
				"          gr_uid_sno,",
				"          gr_manu_date,",
				"          gr_exp_date,",
				"          gr_exe_asn_line_no,",
				"          gr_exe_wh_bat_no,",
				"          gr_exe_supp_bat_no,",
				"          gr_asn_srl_no,",
				"          gr_asn_uid,",
				"          gr_asn_cust_sl_no,",
				"          gr_asn_ref_doc_no1,",
				"          gr_asn_consignee,",
				"          gr_asn_outboundorder_qty,",
				"          gr_asn_bestbeforedate,",
				"          gr_asn_remarks,",
				"          gr_plan_no,",
				"          gr_execution_date,",
				"          gr_reasoncode,",
				"          gr_cross_dock,",
				"          gr_thu_id,",
				"          gr_thu_sno,",
				"          gr_stag_id,",
				"          gr_stock_status,",
				"          gr_inv_type,",
				"          gr_product_status,",
				"          gr_coo,",
				"          gr_item_attribute1,",
				"          gr_item_attribute2,",
				"          gr_item_attribute3,",
				"          gr_item_in_stage,",
				"          gr_item_to_stage,",
				"          gr_pal_status,",
				"          gr_item_hht_save_flag,",
				"          gr_updated_from,",
				"          gr_last_updated_by,",
				"          gr_item_attribute7,",
				"          gr_loc_key,",
				"          gr_emp_hdr_key,",
				"          gr_date_key,",
				"          gr_stg_mas_key,",
				"          gr_pln_no,",
				"          gr_pln_ou,",
				"          gr_pln_date,",
				"          gr_no,",
				"          gr_emp,",
				"          gr_start_date,",
				"          gr_end_date,",
				"          gr_exec_status,",
				"          gr_created_by,",
				"          gr_created_date,",
				"          gr_modified_by,",
				"          gr_modified_date,",
				"          gr_timestamp,",
				"          gr_asn_no,",
				"          gr_staging_id,",
				"          gr_exec_date,",
				"          gr_build_complete,",
				"          gr_notype,",
				"          gr_ref_type,",
				"          gr_gen_from",
				"     )) ~> sink1"
			]
		}
	}
}