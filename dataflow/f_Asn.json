{
	"name": "f_Asn",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_Asnheader",
						"type": "DatasetReference"
					},
					"name": "asnheader"
				},
				{
					"dataset": {
						"referenceName": "ds_Asndetail",
						"type": "DatasetReference"
					},
					"name": "asndetail"
				},
				{
					"dataset": {
						"referenceName": "ds_gatexecdetail",
						"type": "DatasetReference"
					},
					"name": "gateexecdetail"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "df_click_Asn",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "asnhdrdtl"
				},
				{
					"name": "asnhdrgateexec"
				},
				{
					"name": "select1"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          asn_hr_key as long,",
				"          asn_loc_key as long,",
				"          asn_date_key as long,",
				"          asn_cust_key as long,",
				"          asn_supp_key as long,",
				"          asn_ou as integer,",
				"          asn_location as string,",
				"          asn_no as string,",
				"          asn_prefdoc_type as string,",
				"          asn_prefdoc_no as string,",
				"          asn_prefdoc_date as timestamp,",
				"          asn_date as date,",
				"          asn_status as string,",
				"          asn_operation_status as string,",
				"          asn_ib_order as string,",
				"          asn_ship_frm as string,",
				"          asn_ship_date as timestamp,",
				"          asn_dlv_loc as string,",
				"          asn_dlv_date as timestamp,",
				"          asn_sup_asn_no as string,",
				"          asn_sup_asn_date as timestamp,",
				"          asn_sent_by as string,",
				"          asn_rem as string,",
				"          asn_shp_ref_typ as string,",
				"          asn_shp_ref_no as string,",
				"          asn_shp_ref_date as timestamp,",
				"          asn_shp_carrier as string,",
				"          asn_shp_mode as string,",
				"          asn_shp_vh_typ as string,",
				"          asn_shp_vh_no as string,",
				"          asn_shp_eqp_typ as string,",
				"          asn_shp_eqp_no as string,",
				"          asn_shp_grs_wt as decimal(13,2),",
				"          asn_shp_nt_wt as decimal(13,2),",
				"          asn_shp_wt_uom as string,",
				"          asn_shp_vol as decimal(13,2),",
				"          asn_shp_vol_uom as string,",
				"          asn_shp_pallt as integer,",
				"          asn_shp_rem as string,",
				"          asn_cnt_typ as string,",
				"          asn_cnt_no as string,",
				"          asn_cnt_qtyp as string,",
				"          asn_cnt_qsts as string,",
				"          asn_timestamp as integer,",
				"          asn_usrdf1 as string,",
				"          asn_usrdf2 as string,",
				"          asn_usrdf3 as string,",
				"          asn_createdby as string,",
				"          asn_created_date as timestamp,",
				"          asn_modifiedby as string,",
				"          asn_modified_date as timestamp,",
				"          asn_gen_frm as string,",
				"          asn_release_date as timestamp,",
				"          asn_release_number as string,",
				"          asn_block_stage as string,",
				"          asn_amendno as integer,",
				"          asn_cust_code as string,",
				"          asn_supp_code as string,",
				"          asn_quaran_bil_status as string,",
				"          dock_no as string,",
				"          total_value as decimal(13,2),",
				"          asn_gate_no as string,",
				"          asn_type as string,",
				"          asn_wchboinv_bil_status as string,",
				"          asn_adfepasn_bil_status as string,",
				"          asn_reason_code as string,",
				"          asn_whimchpd_sell_bil_status as string,",
				"          asn_wichbain_sell_bil_status as string,",
				"          asn_stpcgthu_bil_status as string,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     inferDriftedColumnTypes: true,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> asnheader",
				"source(output(",
				"          asn_dtl_key as long,",
				"          asn_hr_key as long,",
				"          asn_dtl_loc_key as long,",
				"          asn_dtl_itm_hdr_key as long,",
				"          asn_dtl_thu_key as long,",
				"          asn_dtl_uom_key as long,",
				"          asn_ou as integer,",
				"          asn_location as string,",
				"          asn_no as string,",
				"          asn_lineno as integer,",
				"          asn_line_status as string,",
				"          asn_itm_code as string,",
				"          asn_qty as decimal(20,2),",
				"          asn_batch_no as string,",
				"          asn_srl_no as string,",
				"          asn_manfct_date as timestamp,",
				"          asn_exp_date as timestamp,",
				"          asn_thu_id as string,",
				"          asn_thu_desc as string,",
				"          asn_thu_qty as decimal(20,2),",
				"          po_lineno as integer,",
				"          gr_flag as string,",
				"          asn_rec_qty as decimal(20,2),",
				"          asn_acc_qty as decimal(20,2),",
				"          asn_rej_qty as decimal(20,2),",
				"          asn_thu_srl_no as string,",
				"          asn_rem as string,",
				"          asn_itm_height as decimal(20,2),",
				"          asn_itm_volume as decimal(20,2),",
				"          asn_itm_weight as decimal(20,2),",
				"          asn_order_uom as string,",
				"          asn_master_uom_qty as decimal(20,2),",
				"          asn_cust_sl_no as string,",
				"          asn_ref_doc_no1 as string,",
				"          asn_outboundorder_qty as decimal(20,2),",
				"          asn_bestbeforedate as timestamp,",
				"          asn_itm_length as decimal(20,2),",
				"          asn_itm_breadth as decimal(20,2),",
				"          asn_heightuom as string,",
				"          asn_weightuom as string,",
				"          asn_volumeuom as string,",
				"          asn_user_def_1 as string,",
				"          asn_user_def_2 as decimal(20,2),",
				"          asn_user_def_3 as string,",
				"          asn_hold as integer,",
				"          asn_stock_status as string,",
				"          asn_product_status as string,",
				"          asn_coo as string,",
				"          asn_item_attribute1 as string,",
				"          asn_item_attribute2 as string,",
				"          asn_item_attribute3 as string,",
				"          asn_itm_cust as string,",
				"          asn_cust_po_lineno as integer,",
				"          inb_wr_serial_no as string,",
				"          asn_lottable1 as string,",
				"          asn_lottable2 as string,",
				"          asn_lottable3 as string,",
				"          asn_item_attribute6 as string,",
				"          asn_item_attribute7 as string,",
				"          asn_item_attribute9 as string,",
				"          asn_component as integer,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp,",
				"          asn_itm_itemgroup as string,",
				"          asn_itm_class as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     inferDriftedColumnTypes: true,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> asndetail",
				"source(output(",
				"          gate_exec_dtl_key as long,",
				"          gate_exec_dtl_loc_key as long,",
				"          gate_exec_dtl_veh_key as long,",
				"          gate_exec_dtl_eqp_key as long,",
				"          gate_exec_dtl_emp_hdr_key as long,",
				"          gate_loc_code as string,",
				"          gate_pln_no as string,",
				"          gate_pln_ou as integer,",
				"          gate_exec_no as string,",
				"          gate_exec_ou as integer,",
				"          gate_exec_date as timestamp,",
				"          gate_exec_status as string,",
				"          gate_exec_gateno as string,",
				"          gate_purpose as string,",
				"          gate_flag as string,",
				"          gate_actual_date as timestamp,",
				"          gate_ser_provider as string,",
				"          gate_person as string,",
				"          gate_veh_type as string,",
				"          gate_vehicle_no as string,",
				"          gate_equip_type as string,",
				"          gate_equip_no as string,",
				"          gate_ref_doc_typ1 as string,",
				"          gate_ref_doc_no1 as string,",
				"          gate_ref_doc_typ2 as string,",
				"          gate_ref_doc_no2 as string,",
				"          gate_ref_doc_typ3 as string,",
				"          gate_ref_doc_no3 as string,",
				"          gate_instructions as string,",
				"          gate_employee as string,",
				"          gate_created_by as string,",
				"          gate_created_date as timestamp,",
				"          gate_timestamp as integer,",
				"          gate_userdefined1 as string,",
				"          gate_gatein_no as string,",
				"          gate_customer_name as string,",
				"          gate_vendor_name as string,",
				"          gate_from as string,",
				"          gate_to as string,",
				"          gate_noofunits as integer,",
				"          etlactiveind as integer,",
				"          etljobname as string,",
				"          envsourcecd as string,",
				"          datasourcecd as string,",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     inferDriftedColumnTypes: true,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> gateexecdetail",
				"asnheader, asndetail join(asn_loc_key == asn_dtl_loc_key",
				"     && asnheader@asn_no == asndetail@asn_no,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> asnhdrdtl",
				"asnhdrdtl, gateexecdetail join(asn_loc_key == gate_exec_dtl_loc_key",
				"     && asn_gate_no == gate_exec_no,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> asnhdrgateexec",
				"asnhdrgateexec select(mapColumn(",
				"          asn_hr_key = asnheader@asn_hr_key,",
				"          asn_loc_key,",
				"          asn_date_key,",
				"          asn_cust_key,",
				"          asn_ou = asnheader@asn_ou,",
				"          asn_location = asnheader@asn_location,",
				"          asn_no = asnheader@asn_no,",
				"          asn_prefdoc_type,",
				"          asn_prefdoc_no,",
				"          asn_prefdoc_date,",
				"          asn_date,",
				"          asn_status,",
				"          asn_operation_status,",
				"          asn_ib_order,",
				"          asn_ship_frm,",
				"          asn_ship_date,",
				"          asn_dlv_date,",
				"          asn_sup_asn_no,",
				"          asn_sup_asn_date,",
				"          asn_sent_by,",
				"          asn_rem = asnheader@asn_rem,",
				"          asn_shp_ref_typ,",
				"          asn_shp_ref_no,",
				"          asn_shp_ref_date,",
				"          asn_shp_carrier,",
				"          asn_shp_mode,",
				"          asn_shp_rem,",
				"          asn_created_date,",
				"          asn_modified_date,",
				"          asn_cust_code,",
				"          asn_gate_no,",
				"          asn_type,",
				"          asn_reason_code,",
				"          hdretlactiveind = asnheader@etlactiveind,",
				"          envsourcecd = asnheader@envsourcecd,",
				"          asn_dtl_key,",
				"          asn_dtl_itm_hdr_key,",
				"          asn_lineno,",
				"          asn_line_status,",
				"          asn_itm_code,",
				"          asn_qty,",
				"          asn_rec_qty,",
				"          asn_acc_qty,",
				"          asn_rej_qty,",
				"          asn_order_uom,",
				"          asn_master_uom_qty,",
				"          dtletlactiveind = asndetail@etlactiveind,",
				"          etlcreatedatetime = asndetail@etlcreatedatetime,",
				"          etlupdatedatetime = asndetail@etlupdatedatetime,",
				"          asn_itm_itemgroup,",
				"          asn_itm_class,",
				"          gate_exec_dtl_key,",
				"          gate_exec_dtl_veh_key,",
				"          gate_actual_date,",
				"          gate_ser_provider,",
				"          gate_veh_type,",
				"          gate_vehicle_no,",
				"          gate_employee,",
				"          gate_created_date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 derive(gate_exec_dtl_key = coalesce(gate_exec_dtl_key,-1),",
				"          asn_created_date = coalesce(asn_modified_date,asn_created_date),",
				"          activeindicator = coalesce(hdretlactiveind,dtletlactiveind),",
				"          createdatetime = currentDate(),",
				"          updatedatetime = iifNull(toString(null())),",
				"          asn_cutofftime = iifNull(toString(null())),",
				"          asn_qualifieddate = iifNull(toString(null())),",
				"          asnqualifieddatekey = iifNull(toString(null())),",
				"          asn_openingtime = iifNull(toString(null())),",
				"          gate_exec_dtl_veh_key = coalesce(gate_exec_dtl_veh_key,-1)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          asn_key as long,",
				"          asn_hr_key as long,",
				"          asn_dtl_key as long,",
				"          gate_exec_dtl_key as long,",
				"          asn_loc_key as long,",
				"          asn_date_key as long,",
				"          asn_cust_key as long,",
				"          asn_dtl_itm_hdr_key as long,",
				"          gate_exec_dtl_veh_key as long,",
				"          asn_ou as integer,",
				"          asn_location as string,",
				"          asn_no as string,",
				"          asn_lineno as integer,",
				"          asn_prefdoc_type as string,",
				"          asn_prefdoc_no as string,",
				"          asn_prefdoc_date as timestamp,",
				"          asn_date as date,",
				"          asn_status as string,",
				"          asn_operation_status as string,",
				"          asn_ib_order as string,",
				"          asn_ship_frm as string,",
				"          asn_dlv_date as timestamp,",
				"          asn_sup_asn_no as string,",
				"          asn_sup_asn_date as timestamp,",
				"          asn_sent_by as string,",
				"          asn_ship_date as timestamp,",
				"          asn_rem as string,",
				"          asn_shp_ref_typ as string,",
				"          asn_shp_ref_no as string,",
				"          asn_shp_ref_date as timestamp,",
				"          asn_shp_carrier as string,",
				"          asn_shp_mode as string,",
				"          asn_shp_rem as string,",
				"          asn_cust_code as string,",
				"          asn_type as string,",
				"          asn_reason_code as string,",
				"          asn_gate_no as string,",
				"          asn_created_date as timestamp,",
				"          asn_modified_date as timestamp,",
				"          gate_actual_date as timestamp,",
				"          gate_ser_provider as string,",
				"          gate_veh_type as string,",
				"          gate_vehicle_no as string,",
				"          gate_employee as string,",
				"          gate_created_date as timestamp,",
				"          asn_line_status as string,",
				"          asn_itm_code as string,",
				"          asn_qty as decimal(20,2),",
				"          asn_rec_qty as decimal(20,2),",
				"          asn_acc_qty as decimal(20,2),",
				"          asn_rej_qty as decimal(20,2),",
				"          asn_order_uom as string,",
				"          asn_master_uom_qty as decimal(20,2),",
				"          etlcreatedatetime as timestamp,",
				"          etlupdatedatetime as timestamp,",
				"          createdatetime as timestamp,",
				"          updatedatetime as timestamp,",
				"          asn_itm_itemgroup as string,",
				"          asn_itm_class as string,",
				"          activeindicator as integer,",
				"          asn_cutofftime as timestamp,",
				"          asn_qualifieddate as timestamp,",
				"          asn_qualifieddatekey as long,",
				"          asn_openingtime as timestamp,",
				"          sourcename as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          asn_hr_key,",
				"          asn_dtl_key,",
				"          gate_exec_dtl_key,",
				"          asn_loc_key,",
				"          asn_date_key,",
				"          asn_cust_key,",
				"          asn_dtl_itm_hdr_key,",
				"          gate_exec_dtl_veh_key,",
				"          asn_ou,",
				"          asn_location,",
				"          asn_no,",
				"          asn_lineno,",
				"          asn_prefdoc_type,",
				"          asn_prefdoc_no,",
				"          asn_prefdoc_date,",
				"          asn_date,",
				"          asn_status,",
				"          asn_operation_status,",
				"          asn_ib_order,",
				"          asn_ship_frm,",
				"          asn_dlv_date,",
				"          asn_sup_asn_no,",
				"          asn_sup_asn_date,",
				"          asn_sent_by,",
				"          asn_ship_date,",
				"          asn_rem,",
				"          asn_shp_ref_typ,",
				"          asn_shp_ref_no,",
				"          asn_shp_ref_date,",
				"          asn_shp_carrier,",
				"          asn_shp_mode,",
				"          asn_shp_rem,",
				"          asn_cust_code,",
				"          asn_type,",
				"          asn_reason_code,",
				"          asn_gate_no,",
				"          asn_created_date,",
				"          asn_modified_date,",
				"          gate_actual_date,",
				"          gate_ser_provider,",
				"          gate_veh_type,",
				"          gate_vehicle_no,",
				"          gate_employee,",
				"          gate_created_date,",
				"          asn_line_status,",
				"          asn_itm_code,",
				"          asn_qty,",
				"          asn_rec_qty,",
				"          asn_acc_qty,",
				"          asn_rej_qty,",
				"          asn_order_uom,",
				"          asn_master_uom_qty,",
				"          etlcreatedatetime,",
				"          etlupdatedatetime,",
				"          createdatetime,",
				"          updatedatetime,",
				"          asn_itm_itemgroup,",
				"          asn_itm_class,",
				"          activeindicator,",
				"          asn_cutofftime,",
				"          asn_qualifieddate,",
				"          asn_qualifieddatekey = asnqualifieddatekey,",
				"          asn_openingtime,",
				"          sourcename = envsourcecd",
				"     )) ~> sink1"
			]
		}
	}
}